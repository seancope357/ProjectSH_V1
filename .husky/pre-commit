#!/usr/bin/env sh

# Fail fast and surface errors clearly
set -euo pipefail

echo "[husky] pre-commit: running lint-staged..."

# Prefer local binary to avoid PATH issues; fallback to npx
if [ -x "./node_modules/.bin/lint-staged" ]; then
  ./node_modules/.bin/lint-staged --verbose
else
  npx lint-staged --verbose
fi

status=$?
if [ "$status" -ne 0 ]; then
  echo "[husky] pre-commit: lint-staged failed with exit code $status"
  exit "$status"
fi

echo "[husky] pre-commit: all checks passed."